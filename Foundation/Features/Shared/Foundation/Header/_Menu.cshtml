@model List<Foundation.Cms.ViewModels.Header.MenuItemViewModel>

@{
    string btnName;
    int column = 1;
    int totalChild;
}

<ul class="navigation__left--menu">
    @foreach (var menuItem in Model)
    {
        if (string.IsNullOrEmpty(menuItem.ButtonText))
        {
            btnName = "explore";
        }
        else
        {
            btnName = menuItem.ButtonText;
        }
        <li class="navigation__item">
            <a href="@menuItem.Uri" class="nav-category">
                @menuItem.Name
            </a>
            @if (menuItem.ChildLinks.Count > 0)
            {
                <div class="mega-container">
                    <div class="mega-menu--header__item">
                        <div class="col-md-auto" style="width: 700px;">
                            <div class="row">
                                @{
                                    totalChild = menuItem.ChildLinks.Count > 4 ? 4 : menuItem.ChildLinks.Count;
                                    column = 12 / totalChild;
                                    var index = 0;

                                    foreach (var childHeader in menuItem.ChildLinks)
                                    {
                                        <div class="col-@column">
                                            <ul class="category__item">
                                                <li class="main-category">@childHeader.MainCategoryText</li>
                                                @foreach (var childLink in childHeader.ListCategories)
                                                {
                                                    <li>
                                                        <a class="link" href="@Url.GetFriendlyUrl(childLink.Href)">
                                                            @childLink.Text
                                                        </a>
                                                    </li>
                                                }
                                            </ul>
                                        </div>
                                        index++;

                                        if (index > column) { break; }
                                    }
                                }
                            </div>
                        </div>
                        <div class="row mega-menu--image-box__lg">
                            <div class="category__image col-lg-6">
                                <picture class="img-fluid">
                                    <source srcset="@menuItem.ImageUrl?width=510&format=webp" type="image/webp">
                                    <img class="img-fluid" src="@menuItem.ImageUrl?width=510" loading="lazy" />
                                </picture>
                            </div>
                            <div class="col-lg-6 flex-center">
                                <div>
                                    <a href="@menuItem.ButtonLink" class="mega-menu__title">
                                        @Html.Raw(menuItem.TeaserText)
                                    </a>
                                    <a href="@menuItem.ButtonLink" class="button-transparent-black">@btnName</a>
                                </div>

                            </div>
                        </div>
                        <div class="mega-menu--image-box__sm">
                            <div class="box-image-btn-text">
                                <picture class="img-fluid">
                                    <source srcset="@menuItem.ImageUrl?width=510&format=webp" type="image/webp">
                                    <img class="img-fluid" src="@menuItem.ImageUrl?width=510" loading="lazy" />
                                </picture>
                                <div class="button-text">
                                    <a href="@menuItem.ButtonLink" class="mega-menu__title--inverse">
                                        @Html.Raw(menuItem.TeaserText)
                                    </a>
                                    <a href="@menuItem.ButtonLink" class="button-white">@btnName</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            }
        </li>
    }
</ul>